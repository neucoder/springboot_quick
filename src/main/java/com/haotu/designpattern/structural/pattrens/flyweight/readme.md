# 享元模式

享元模式（Flyweight Pattern）： 主要用于减少创建对象的数量，以减少内存占用和提高性能。
在面向对象程序的设计过程中，有时需要创建大量相似的对象实例。
如果都创建将会消耗很多系统资源，它是系统性能提高的一个瓶颈。
但如果将这些对象的相似部分抽取出来共享，则能节约大量的系统资源，这就是享元模式的产生背景。
在 Java 中 String 值的存储就使用了享元模式，相同的值只存一个。


享元(Flyweight)模式是一种用于性能优化的设计模式。它通过共享技术有效支持大量细粒度的对象。
享元模式尝试重用已经存在的同类对象,减少对象的创建,降低内存占用,提高性能。

享元模式的关键是区分内蕴状态(intrinsic state)和外部状态(extrinsic state)。

- 内蕴状态存储在享元对象内部,不会随环境改变,例如颜色、材质等属性。

- 外部状态依赖于环境,不存储在享元对象内部,例如位置、大小等属性。

享元模式的实现需要包括以下几点:

- 抽取出对象的内蕴状态和外部状态

- 创建抽象享元类定义对象共享的接口

- 创建具体享元类实现抽象享元类,并包含内蕴状态

- 创建享元工厂类,管理共享对象的池

- 在客户端中使用享元工厂获取和使用享元对象

例子:

- 棋牌游戏的棋子,只需要一组有限的棋子对象即可完成游戏

- 文字编辑器中各种字体和字号的组合,共享相同的字符作为享元对象

- 地图中的省、市区域对象,相同的区域可以重用一个享元对象

- 游戏场景中的重复出现的物体,如石头、树木等

所以享元模式通过对象复用和外部状态存储,有效地支持大规模的细粒度对象,减少内存占用。